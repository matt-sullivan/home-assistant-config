# spotify_test_1:
#   alias: Spotify Play Old
#   description:
#     Attempt to play playlist in spotify, but built-in method only works
#     if devide already active
#   sequence:
#     - service: media_player.select_source
#       target:
#         entity_id: media_player.spotify_matt_sullivan
#       data:
#         source: Lounge tv
#     - service: media_player.play_media
#       data:
#         media_content_type: playlist
#         media_content_id: https://open.spotify.com/playlist/3WhE0IEbLZ0VABA5joDiTs
#       target:
#         entity_id:
#           - media_player.spotify_matt_sullivan
#   mode: single
#
spotify_test_2:
  alias: Spotify/google home test
  description: Attempt to play spotify on kitchen google home, this does work
    (as long as the HACS custom component version matches the spotify component and the cast component provided by the OS)
    continue_on_error doesn't appear to work, because it's often an exception/compile error rather than error result 
  sequence:
    - service: spotcast.start
      continue_on_error: true
      data:
        account: "sara"
        search: "Taylor"
        random_song: true
        start_volume: 10
        entity_id: media_player.kitchen_speaker
  mode: restart

kids_wakeup:
  alias: Kids Wake Up
  description: Start kids wake up music and lights
  variables:
    chromecast_id: media_player.emilys_room_speaker
    count: 10
    max_volume: 0.5
  sequence:
    - service: spotcast.start
      continue_on_error: true
      data:
        uri: spotify:playlist:4WyHdt802ozHHPWq1BNUUB
        random_song: true
        repeat: true
        shuffle: true
        start_volume: 20
        entity_id: "{{chromecast_id}}"
    - service: scene.apply
      data:
        entities:
          switch.fishtank:
            state: "on"
    - repeat:
        count: "{{count}}"
        sequence:
          - service: media_player.volume_set
            target:
              entity_id: "{{chromecast_id}}"
            data:
              volume_level: "{{repeat.index|float / count * max_volume}}"
          - service: scene.apply
            data:
              entities:
                light.emily_reading:
                  brightness: "{{repeat.index|float / count * 255}}"
                  state: "on"
                light.toby_reading:
                  brightness: "{{repeat.index|float / count * 255}}"
                  state: "on"
                light.kids_long_w:
                  brightness: "{{repeat.index|float / count * 255}}"
                  state: "on"
                light.kids_short_w:
                  brightness: "{{repeat.index|float / count * 255}}"
                  state: "on"
                light.kids_long_rgb:
                  state: "off"
                light.kids_short_rgb:
                  state: "off"
          - delay:
              hours: 0
              minutes: 1
              seconds: 0
              milliseconds: 0
  mode: restart

toby_sleep_time:
  alias: Toby Sleep Time
  description: Sleep music and night lights
  variables:
    steps: 30
    start_brightness: 120
    end_brightness: 64
    rgb_nightlight_brightness_start: 163
    rgb_nightlight_brightness_end: 125
  sequence:
    - service: scene.apply
      data:
        entities:
          light.kids_short_rgb:
            color_mode: hs
            brightness: "{{rgb_nightlight_brightness_start}}"
            hs_color:
              - 120
              - 70
            state: "on"
          light.kids_long_rgb:
            color_mode: hs
            brightness: "{{start_brightness}}"
            hs_color:
              - 120
              - 70
            state: "on"
          light.kids_short_w:
            state: "off"
          light.emily_reading:
            state: "off"
          light.toby_reading:
            state: "off"
          light.kids_long_w:
            state: "off"
          switch.fishtank:
            state: "off"
    - service: spotcast.start
      continue_on_error: true
      data:
        uri: spotify:playlist:0fpnB1xETz7cpfsuZAAgsK
        repeat: true
        start_volume: 30
        # actually toby's speaker, called emily's from when they shared bedroom
        entity_id: media_player.emilys_room_speaker
    - repeat:
        count: "{{steps}}"
        sequence:
          - service: scene.apply
            data:
              entities:
                light.kids_short_rgb:
                  brightness: "{{rgb_nightlight_brightness_start + ((rgb_nightlight_brightness_end - rgb_nightlight_brightness_start) * (repeat.index|float / steps))}}"
                  state: "on"
                light.kids_long_rgb:
                  brightness: "{{start_brightness + ((end_brightness - start_brightness) * (repeat.index|float / steps))}}"
                  state: "on"
          - delay:
              hours: 0
              minutes: 1
              seconds: 0
              milliseconds: 0
    - delay:
        hours: 2
        minutes: 0
        seconds: 0
        milliseconds: 0
    - service: scene.apply
      data:
        entities:
          light.kids_long_rgb:
            state: "off"
    - service: media_player.turn_off
      data:
        entity_id: media_player.emilys_room_speaker
  mode: restart

emily_reading_time:
  alias: Emily Reading Time
  description: Emily lights for bedtime reading
  variables:
    start_brightness: 200
  sequence:
    - service: scene.apply
      data:
        entities:
          light.emilys_bedroom_light:
            color_mode: rgb
            brightness: "{{start_brightness}}"
            rgb_color:
              - 255
              - 255
              - 255
            state: "on"

emily_sleep_time:
  alias: Emily Sleep Time
  description: Emily's sleep music and night lights
  variables:
    steps: 30
    start_brightness: 102
    end_brightness: 39
    start_volume: 50
    end_volume: 35
  sequence:
    - service: scene.apply
      data:
        entities:
          light.emilys_bedroom_light:
            color_mode: rgb
            brightness: "{{start_brightness}}"
            rgb_color:
              - 255
              - 255
              - 255
            state: "on"
    - service: spotcast.start
      continue_on_error: true
      data:
        account: "emily"
        # Dork diaries
        uri: spotify:playlist:5N5yfWfwP9faFo9iQjGQO3
        repeat: true
        start_volume: 50
        # Emilys speaker
        entity_id: media_player.googlehome1978
    - repeat:
        count: "{{steps}}"
        sequence:
          - service: scene.apply
            data:
              entities:
                light.emilys_bedroom_light:
                  brightness: "{{start_brightness + ((end_brightness - start_brightness) * (repeat.index|float / steps))}}"
                  state: "on"
          - service: media_player.volume_set
            data:
              entity_id: media_player.kitchen_speaker
              volume_level: "{{start_volume + ((end_volume - start_volume) * (repeat.index|float / steps))}}"
          - delay:
              hours: 0
              minutes: 1
              seconds: 0
              milliseconds: 0
  mode: restart
